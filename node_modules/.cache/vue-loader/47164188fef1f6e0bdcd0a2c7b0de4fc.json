{"remainingRequest":"/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/src/components/MeetingPlaner.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/src/components/MeetingPlaner.vue","mtime":1575886891683},{"path":"/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liza/Desktop/testovoe/Testovoe/meeting-planner/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEFjdGlvbnMsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IFVzZXJFZGl0b3IgZnJvbSAnLi9Vc2VyRWRpdG9yLnZ1ZSc7CmltcG9ydCBNZWV0aW5nRWRpdG9yIGZyb20gJy4vTWVldGluZ0VkaXRvci52dWUnOwppbXBvcnQgTWVldGluZ0NhcmQgZnJvbSAnLi9NZWV0aW5nQ2FyZC52dWUnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdNZWV0aW5nUGxhbmVyJywKCiAgZGF0YTogKCkgPT4gKHsKICAgIG5ld1VzZXJEaWFsb2c6IGZhbHNlLAogICAgbWVldGluZ0VkaXRvcjogZmFsc2UsCiAgICB1c2VyRGlzYWJsZWQ6IFtdLAogIH0pLAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsKICAgICAgJ3VzZXJMaXN0X2dldCcsCiAgICAgICdtZWV0aW5nTGlzdF9nZXQnCiAgICBdKSwKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIFVzZXJFZGl0b3IsCiAgICBNZWV0aW5nRWRpdG9yLAogICAgTWVldGluZ0NhcmQKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoWwogICAgICAnY3JlYXRlTmV3VXNlcicsCiAgICAgICdjcmVhdGVOZXdNZWV0aW5nJywKICAgICAgJ3VwZGF0ZURhdGFGcm9tU3RvcmFnZScKICAgIF0pLAogICAgY3JlYXRlVXNlcih1c2VyKSB7CiAgICAgIHRoaXMuY3JlYXRlTmV3VXNlcih7IHBheWxvYWQ6IHVzZXIgfSkKICAgICAgdGhpcy5uZXdVc2VyRGlhbG9nID0gZmFsc2U7CiAgICB9LAogICAgY3JlYXRlTWVldGluZyhtZWV0aW5nKXsKICAgICAgaWYgKCFtZWV0aW5nLmZhY2lsaXRhdG9yfHwhbWVldGluZy5zZWNyZXRhcnkpIHsKICAgICAgICBhbGVydCgn0JfQsNC/0L7Qu9C90LjRgtC1INGA0L7Qu9GMINGE0LDRgdC40LvQuNGC0LDRgtC+0YDQsCDQuCDRgdC10LrRgNC10YLQsNGA0Y8sINC/0YDQtdC20LTQtSDRh9C10Lwg0YHQvtC30LTQsNGC0Ywg0LLRgdGC0YDQtdGH0YMnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAobWVldGluZy50aW1lRnJvbSA+IG1lZXRpbmcudGltZVRvKSB7CiAgICAgICAgYWxlcnQoJ9CS0YDQtdC80Y8g0L3QsNGH0LDQu9CwINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQsdC+0LvRjNGI0LUg0YfQtdC8INC+0LrQvtC90YfQsNC90LjQtSDQstGB0YLRgNC10YfQuCcpOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNyZWF0ZU5ld01lZXRpbmcoeyBwYXlsb2FkOiBtZWV0aW5nIH0pCiAgICAgICAgdGhpcy5tZWV0aW5nRWRpdG9yID0gZmFsc2U7CiAgICAgICAgdGhpcy51c2VyRGlzYWJsZWQgPSBbXTsKICAgICAgfQoKICAgIH0sCiAgICBjaGVja0F2YWlsYWJpbGl0eSh0aW1lRnJvbSwgdGltZVRvKSB7CiAgICAgIGNvbnN0IHNldCA9IG5ldyBTZXQoKTsKICAgICAgdGhpcy5tZWV0aW5nTGlzdF9nZXQuZm9yRWFjaChlbCA9PiB7CiAgICAgICAgaWYgKChlbC50aW1lRnJvbSA+PSB0aW1lRnJvbSYmZWwudGltZUZyb20gPD0gdGltZVRvKXx8KGVsLnRpbWVUbyA+PSB0aW1lRnJvbSYmIGVsLnRpbWVUbyA8PSB0aW1lVG8pfHwoZWwudGltZUZyb20gPCB0aW1lRnJvbSYmZWwudGltZVRvID4gdGltZVRvKSkgewogICAgICAgICAgZWwucGFydGljaXBhbnRzLmZvckVhY2gocGFydCA9PiBzZXQuYWRkKHBhcnQpKQogICAgICAgIH0KICAgICAgdGhpcy51c2VyRGlzYWJsZWQgPSBbLi4uc2V0XQogICAgICB9KQogICAgfSwKICAgIGdldFN0b3JhZ2VVcGRhdGUoZSkgewogICAgICBpZiAoZXZlbnQua2V5ID09PSAndXNlckxpc3QnfHxldmVudC5rZXkgPT09ICdtZWV0aW5nTGlzdCcpIHRoaXMudXBkYXRlRGF0YUZyb21TdG9yYWdlKHsgcGF5bG9hZDogeyBrZXk6IGV2ZW50LmtleSwgZGF0YTogSlNPTi5wYXJzZShldmVudC5uZXdWYWx1ZSl9IH0pCiAgICB9CiAgfSwKCiAgbW91bnRlZCgpewogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyTGlzdCcpKSB0aGlzLnVwZGF0ZURhdGFGcm9tU3RvcmFnZSh7IHBheWxvYWQ6IHsga2V5OiAndXNlckxpc3QnLCBkYXRhOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyTGlzdCcpKX0gfSkKICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbWVldGluZ0xpc3QnKSkgdGhpcy51cGRhdGVEYXRhRnJvbVN0b3JhZ2UoeyBwYXlsb2FkOiB7IGtleTogJ21lZXRpbmdMaXN0JywgZGF0YTogSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbWVldGluZ0xpc3QnKSl9IH0pCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuZ2V0U3RvcmFnZVVwZGF0ZSk7CiAgfSwKICBiZWZvcmVEZXN0cm95KCl7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuZ2V0U3RvcmFnZVVwZGF0ZSk7CiAgfQp9Owo="},{"version":3,"sources":["MeetingPlaner.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MeetingPlaner.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-container>\n    <v-layout row wrap>\n      <v-flex xs3>\n        <v-layout row wrap user-list>\n          <v-flex xs12>\n            Список пользователей:\n          </v-flex>\n          <v-flex xs12>\n            <div class='user-card' v-for='el in userList_get'>\n              <h3>{{ el.name + ' ' + el.surname }}</h3>\n            </div>\n          </v-flex>\n          <v-flex xs12 button-box>\n            <v-btn fab dark color=\"indigo\" @click='newUserDialog = true'>\n              <v-icon dark>mdi-plus</v-icon>\n            </v-btn>\n          </v-flex>\n        </v-layout>\n      </v-flex>\n      <v-flex xs9>\n        <v-flex xs12>\n          <v-btn class=\"mx-2\" block dark color=\"indigo\" @click='meetingEditor = true'>\n            Добавить встречу\n          </v-btn>\n        </v-flex>\n        <v-flex xs12>\n          <v-layout row wrap>\n            <v-flex xs3 v-for='el in meetingList_get'>\n              <MeetingCard :meeting='el'/>\n            </v-flex>\n          </v-layout>\n        </v-flex>\n      </v-flex>\n    </v-layout>\n    <UserEditor v-if='newUserDialog'\n                @cancel='newUserDialog = false'\n                @createUser='createUser'/>\n    <MeetingEditor v-if='meetingEditor'\n                   :users='userList_get'\n                   :userDisabled='userDisabled'\n                   @cancel='meetingEditor = false, userDisabled = []'\n                   @createMeeting='createMeeting'\n                   @checkAvailability='checkAvailability'/>\n  </v-container>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex';\nimport UserEditor from './UserEditor.vue';\nimport MeetingEditor from './MeetingEditor.vue';\nimport MeetingCard from './MeetingCard.vue';\n\nexport default {\n  name: 'MeetingPlaner',\n\n  data: () => ({\n    newUserDialog: false,\n    meetingEditor: false,\n    userDisabled: [],\n  }),\n  computed: {\n    ...mapGetters([\n      'userList_get',\n      'meetingList_get'\n    ]),\n  },\n  components: {\n    UserEditor,\n    MeetingEditor,\n    MeetingCard\n  },\n  methods: {\n    ...mapActions([\n      'createNewUser',\n      'createNewMeeting',\n      'updateDataFromStorage'\n    ]),\n    createUser(user) {\n      this.createNewUser({ payload: user })\n      this.newUserDialog = false;\n    },\n    createMeeting(meeting){\n      if (!meeting.facilitator||!meeting.secretary) {\n        alert('Заполните роль фасилитатора и секретаря, прежде чем создать встречу');\n        return;\n      } else if (meeting.timeFrom > meeting.timeTo) {\n        alert('Время начала не может быть больше чем окончание встречи');\n        return;\n      } else {\n        this.createNewMeeting({ payload: meeting })\n        this.meetingEditor = false;\n        this.userDisabled = [];\n      }\n\n    },\n    checkAvailability(timeFrom, timeTo) {\n      const set = new Set();\n      this.meetingList_get.forEach(el => {\n        if ((el.timeFrom >= timeFrom&&el.timeFrom <= timeTo)||(el.timeTo >= timeFrom&& el.timeTo <= timeTo)||(el.timeFrom < timeFrom&&el.timeTo > timeTo)) {\n          el.participants.forEach(part => set.add(part))\n        }\n      this.userDisabled = [...set]\n      })\n    },\n    getStorageUpdate(e) {\n      if (event.key === 'userList'||event.key === 'meetingList') this.updateDataFromStorage({ payload: { key: event.key, data: JSON.parse(event.newValue)} })\n    }\n  },\n\n  mounted(){\n    if (localStorage.getItem('userList')) this.updateDataFromStorage({ payload: { key: 'userList', data: JSON.parse(localStorage.getItem('userList'))} })\n    if (localStorage.getItem('meetingList')) this.updateDataFromStorage({ payload: { key: 'meetingList', data: JSON.parse(localStorage.getItem('meetingList'))} })\n    window.addEventListener('storage', this.getStorageUpdate);\n  },\n  beforeDestroy(){\n    window.removeEventListener('storage', this.getStorageUpdate);\n  }\n};\n</script>\n\n<style>\n.meeting-card {\n  background: #FFF4AA;\n  box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.2);\n  border-radius: 3px;\n  margin: 10px;\n  padding:10px;\n}\n\n.meeting-time {\n  font-weight: 300;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.meeting-status.planned {\n  color: #156711\n}\n\n.meeting-status.ended {\n  color: #801515\n}\n\n.meeting-status.going {\n  color: #152C55\n}\n\n.button-box {\n  margin-top: 20px;\n}\n</style>\n"]}]}